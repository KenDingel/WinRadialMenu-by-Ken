<UserControl x:Class="RadialMenu.Controls.TreeMenuEditor"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:RadialMenu.Controls">
    <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch" Margin="0,0,0,8">
        <!-- Toolbar -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="0,0,0,8">
            <Button Content="Add Item" Command="{Binding AddMenuItemCommand}" Margin="0,0,4,0" Padding="8,4"/>
            <Button Content="Duplicate" Command="{Binding DuplicateMenuItemCommand}" Margin="0,0,4,0" Padding="8,4"/>
            <Button Content="Delete" Command="{Binding DeleteMenuItemCommand}" Margin="0,0,4,0" Padding="8,4"/>
            <Separator Margin="8,0"/>
            <Button Content="Indent" Command="{Binding IndentCommand}" Margin="0,0,4,0" Padding="8,4"/>
            <Separator Margin="8,0"/>
            <TextBlock Text="Multi-Select:" VerticalAlignment="Center" Margin="8,0,4,0"/>
            <Button Content="Clear Selection" Click="ClearMultiSelection_Click" Margin="0,0,4,0" Padding="8,4"/>
        </StackPanel>

        <!-- Grid containing Tree View and Status -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Tree View -->
            <TreeView Grid.Row="0" 
                      x:Name="MenuTreeView"
                      ItemsSource="{Binding Working.Menu}"
                      SelectedItemChanged="TreeView_SelectedItemChanged"
                      AllowDrop="True"
                      PreviewMouseLeftButtonDown="TreeView_PreviewMouseLeftButtonDown"
                      PreviewMouseMove="TreeView_PreviewMouseMove"
                      Drop="TreeView_Drop">
                <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Submenu}">
                        <StackPanel Orientation="Horizontal">
                            <CheckBox x:Name="MultiSelectCheckBox" 
                                      Margin="0,0,8,0" 
                                      VerticalAlignment="Center"
                                      Checked="MultiSelectCheckBox_Checked"
                                      Unchecked="MultiSelectCheckBox_Unchecked"/>
                            <TextBlock Text="{Binding Icon}" FontSize="14" Margin="0,0,4,0"/>
                            <TextBlock Text="{Binding Label}" />
                        </StackPanel>
                    </HierarchicalDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>

            <!-- Status -->
            <TextBlock Grid.Row="1" Text="{Binding MenuStatusText}" Margin="0,8,0,0" Foreground="Gray"/>
        </Grid>
    </StackPanel>
</UserControl>

