<Window x:Class="RadialMenu.Views.SettingsWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:RadialMenu.Controls"
    Title="Settings" Height="800" Width="1200" WindowStartupLocation="CenterOwner"
    Background="{StaticResource BackgroundBrush}"
    Foreground="{StaticResource TextBrush}"
    Topmost="True">
    <Window.Resources>
        <!-- Modern color scheme -->
        <Color x:Key="AccentColor">#FF2D7DD2</Color>
        <Color x:Key="BackgroundColor">#E6000000</Color>
        <Color x:Key="HoverColor">#FF45A5FF</Color>
        <Color x:Key="TextColor">#FFFFFFFF</Color>
        
        <SolidColorBrush x:Key="AccentBrush" Color="{StaticResource AccentColor}"/>
        <SolidColorBrush x:Key="BackgroundBrush" Color="{StaticResource BackgroundColor}"/>
        <SolidColorBrush x:Key="HoverBrush" Color="{StaticResource HoverColor}"/>
        <SolidColorBrush x:Key="TextBrush" Color="{StaticResource TextColor}"/>

        <!-- Modern button style -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="TextBox" BasedOn="{StaticResource {x:Type TextBox}}">
            <Setter Property="Background" Value="{StaticResource BackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
        <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
            <Setter Property="Background" Value="{StaticResource BackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
        <Style TargetType="ComboBoxItem" BasedOn="{StaticResource {x:Type ComboBoxItem}}">
            <Setter Property="Background" Value="{StaticResource BackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
        </Style>
        <Style TargetType="Slider" BasedOn="{StaticResource {x:Type Slider}}">
            <Setter Property="Foreground" Value="{StaticResource AccentBrush}"/>
        </Style>
    </Window.Resources>
    <DockPanel>
        <!-- Toolbar spanning full width at the bottom -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" DockPanel.Dock="Bottom" Margin="12">
            <Button Content="Undo" Margin="8" Width="120" Height="50" FontSize="18" Command="{Binding UndoCommand}" IsEnabled="{Binding CanUndo}" Style="{StaticResource ModernButton}" />
            <Button Content="Redo" Margin="8" Width="120" Height="50" FontSize="18" Command="{Binding RedoCommand}" IsEnabled="{Binding CanRedo}" Style="{StaticResource ModernButton}" />
            <Button x:Name="BtnImport" Content="Import" Margin="8" Width="140" Height="50" FontSize="18" Style="{StaticResource ModernButton}" Command="{Binding ImportCommand}" />
            <Button x:Name="BtnExport" Content="Export" Margin="8" Width="140" Height="50" FontSize="18" Style="{StaticResource ModernButton}" Command="{Binding ExportCommand}" />
        </StackPanel>

        <!-- Existing content wrapped in a DockPanel -->
        <Grid DockPanel.Dock="Top">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="220" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="300" />
            </Grid.ColumnDefinitions>

        <!-- Left navigation -->
        <StackPanel Grid.Column="0" Background="#111" Margin="8">
                <TextBlock Text="Settings" Foreground="White" FontSize="18" Margin="6" />
                <Button x:Name="BtnGeneral" Content="General" Margin="4" Command="{Binding NavigateCommand}" CommandParameter="General" Style="{StaticResource ModernButton}" />
                <Button x:Name="BtnHotkeys" Content="Hotkeys" Margin="4" Command="{Binding NavigateCommand}" CommandParameter="Hotkeys" Style="{StaticResource ModernButton}" />
                <Button x:Name="BtnAppearance" Content="Appearance" Margin="4" Command="{Binding NavigateCommand}" CommandParameter="Appearance" Style="{StaticResource ModernButton}" />
                <Button x:Name="BtnMenu" Content="Menu Builder" Margin="4" Command="{Binding NavigateCommand}" CommandParameter="Menu" Style="{StaticResource ModernButton}" />
                <Button x:Name="BtnAdvanced" Content="Advanced" Margin="4" Command="{Binding NavigateCommand}" CommandParameter="Advanced" Style="{StaticResource ModernButton}" />
                <Button x:Name="BtnDiagnostics" Content="Diagnostics" Margin="4" Command="{Binding NavigateCommand}" CommandParameter="Diagnostics" Style="{StaticResource ModernButton}" />
            </StackPanel>

            <!-- Content area -->
            <Border Grid.Column="1" Padding="12" Background="{StaticResource BackgroundBrush}">
                <ContentControl x:Name="ContentHost" />
            </Border>

            <!-- Right properties / preview -->
            <Border Grid.Column="2" Padding="12" Background="#141414">
                <local:MenuItemProperties />
            </Border>

            <!-- Save Button moved to a dedicated row -->
            <DockPanel Grid.Row="0" LastChildFill="False" Margin="12" Height="80">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button x:Name="BtnSave" Content="Save Settings" Margin="8" Width="200" Height="60" FontSize="20" FontWeight="Bold" Command="{Binding SaveCommand}" IsEnabled="{Binding IsDirty}" Style="{StaticResource ModernButton}" />
                </StackPanel>
            </DockPanel>
        </Grid>

        <!-- Corrected visibility binding for the Menu Item Properties panel -->
        <StackPanel x:Name="MenuItemPropertiesPanel" Visibility="{Binding IsMenuBuilderPageVisible, Converter={StaticResource BooleanToVisibilityConverter}}">
            <!-- Menu Item Properties content -->

            <!-- Color Selection Grid -->
            <TextBlock Text="Select Color" FontWeight="Bold" FontSize="14" Margin="0,8,0,4" />
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Button Background="Red" Width="40" Height="40" Grid.Row="0" Grid.Column="0" Command="{Binding SelectColorCommand}" CommandParameter="Red" />
                <Button Background="Green" Width="40" Height="40" Grid.Row="0" Grid.Column="1" Command="{Binding SelectColorCommand}" CommandParameter="Green" />
                <Button Background="Blue" Width="40" Height="40" Grid.Row="0" Grid.Column="2" Command="{Binding SelectColorCommand}" CommandParameter="Blue" />
                <Button Background="Yellow" Width="40" Height="40" Grid.Row="1" Grid.Column="0" Command="{Binding SelectColorCommand}" CommandParameter="Yellow" />
                <Button Background="Purple" Width="40" Height="40" Grid.Row="1" Grid.Column="1" Command="{Binding SelectColorCommand}" CommandParameter="Purple" />
                <Button Background="Orange" Width="40" Height="40" Grid.Row="1" Grid.Column="2" Command="{Binding SelectColorCommand}" CommandParameter="Orange" />
            </Grid>

            <!-- Emoji Selection Grid -->
            <TextBlock Text="Select Emoji" FontWeight="Bold" FontSize="14" Margin="0,8,0,4" />
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Button Content="ðŸ˜€" Width="40" Height="40" Grid.Row="0" Grid.Column="0" Command="{Binding SelectEmojiCommand}" CommandParameter="ðŸ˜€" />
                <Button Content="ðŸŽ‰" Width="40" Height="40" Grid.Row="0" Grid.Column="1" Command="{Binding SelectEmojiCommand}" CommandParameter="ðŸŽ‰" />
                <Button Content="ðŸ”¥" Width="40" Height="40" Grid.Row="0" Grid.Column="2" Command="{Binding SelectEmojiCommand}" CommandParameter="ðŸ”¥" />
                <Button Content="ðŸŒŸ" Width="40" Height="40" Grid.Row="1" Grid.Column="0" Command="{Binding SelectEmojiCommand}" CommandParameter="ðŸŒŸ" />
                <Button Content="ðŸ’¡" Width="40" Height="40" Grid.Row="1" Grid.Column="1" Command="{Binding SelectEmojiCommand}" CommandParameter="ðŸ’¡" />
                <Button Content="ðŸš€" Width="40" Height="40" Grid.Row="1" Grid.Column="2" Command="{Binding SelectEmojiCommand}" CommandParameter="ðŸš€" />
            </Grid>
        </StackPanel>
    </DockPanel>
</Window>
